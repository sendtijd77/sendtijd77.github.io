<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antibot & Cloaking System</title>
    <script>
        // Configuratie voor antibot gevoeligheid
        const antibotConfig = {
            logDetails: true, // Log verdachte gebruikers
            redirectBots: true, // Redirect bots naar whitepage
            showNeutralPage: false, // Toon neutrale inhoud aan verdachte gebruikers
            whitePage: "https://badbotstraffic-to.here/",
            trustedDelay: 1000, // Tijd in ms voor vertraging bij legitiem verkeer
            botKeywords: [
                "bot", "crawl", "spider", "mediapartners", "slurp", "wget", "curl",
                "python", "java", "fetch", "libwww", "urllib", "node-fetch", "headless"
            ]
        };

        // Functie: Haal een queryparameter op uit de URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Functie: Dynamische redirect gebaseerd op 'id'
        function redirectBasedOnId() {
            const id = getQueryParam("id");
            const redirectMap = {
                "123": "https://youtube.com",
                "456": "https://google.com",
                "789": "https://facebook.com"
            };

            if (id && redirectMap[id]) {
                window.location.href = redirectMap[id];
            } else {
                document.body.innerHTML = `
                    <h1>Invalid Request</h1>
                    <p>No valid redirect found for the provided 'id'.</p>
                `;
            }
        }

        // Functie: Antibotdetectie
        function detectBot() {
            const { botKeywords } = antibotConfig;
            const userAgent = navigator.userAgent || "";

            // Controleer op verdachte User-Agent keywords
            for (const keyword of botKeywords) {
                if (userAgent.toLowerCase().includes(keyword)) {
                    console.log("Suspicious User-Agent detected:", userAgent);
                    return true;
                }
            }

            // Headless browser detectie via navigator.webdriver
            if (navigator.webdriver) {
                console.log("Headless browser detected.");
                return true;
            }

            // Verdachte snelheden (toekomstige implementatie)
            // Plaats logica hier voor snelheid van interactie

            return false; // Verkeer wordt als legitiem beschouwd
        }

        // Functie: Toon neutrale inhoud
        function showNeutralContent() {
            document.body.innerHTML = `
                <h1>Welcome</h1>
                <p>This is a neutral page shown to suspected bots.</p>
            `;
        }

        // Functie: Logging voor verdachte gebruikers
        function logSuspectedTraffic() {
            if (antibotConfig.logDetails) {
                const userAgent = navigator.userAgent;
                const language = navigator.language || "unknown";
                console.log("Suspicious Traffic Logged:");
                console.log(`User-Agent: ${userAgent}`);
                console.log(`Language: ${language}`);
            }
        }

        // Functie: Verbeterde link cloaking
        function improvedLinkCloaking() {
            // a. Dynamische URL-aanpassing voor cloaking
            const links = document.querySelectorAll('a');
            links.forEach(link => {
                link.href = `/cloaked?target=${encodeURIComponent(link.href)}`;
            });

            // b. Beveiliging tegen inspectietools
            document.addEventListener('contextmenu', event => event.preventDefault());
            document.addEventListener('keydown', event => {
                if (event.key === 'F12' || (event.ctrlKey && event.shiftKey && event.key === 'I')) {
                    event.preventDefault();
                }
            });

            // c. Tijdgebaseerde cloaking
            setTimeout(() => {
                console.log("Cloaking check passed: showing actual links.");
            }, 2000);
        }

        // Functie: Veilige redirect implementatie
        function safeRedirect(url) {
            // Valideer URL voordat er wordt doorgestuurd
            try {
                const validatedUrl = new URL(url);
                window.location.href = validatedUrl.href;
            } catch (error) {
                console.error("Invalid URL provided for redirect:", url);
            }
        }

        // Monitoring en Optimalisatie
        function monitorAndOptimize() {
            // a. Real-time monitoring van gebruikersgedrag
            window.addEventListener('mousemove', () => console.log("Mouse movement detected"));

            // b. Optimalisaties toepassen
            document.body.style.transition = "opacity 0.3s ease";
        }

        // Uitvoeren van logica bij het laden van de pagina
        document.addEventListener("DOMContentLoaded", () => {
            improvedLinkCloaking();
            const isBot = detectBot();

            if (isBot) {
                logSuspectedTraffic();

                if (antibotConfig.redirectBots) {
                    window.location.href = antibotConfig.whitePage;
                } else if (antibotConfig.showNeutralPage) {
                    showNeutralContent();
                }
            } else {
                setTimeout(() => {
                    redirectBasedOnId();
                }, antibotConfig.trustedDelay);

                monitorAndOptimize();
            }
        });
    </script>
    <noscript>
        <style>body { display: none; }</style>
        <h1>JavaScript Required</h1>
        <p>This page requires JavaScript to function properly. Please enable JavaScript in your browser.</p>
    </noscript>
</head>
<body></body>
</html>
